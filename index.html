<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E.M.A - Club N√°utico Reloncav√≠</title>

<!-- Fuentes y iconos -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/phosphor-icons@1.4.2/src/css/phosphor.css" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />

<style>
body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(160deg, #001a33, #002b55, #001a33);
    color: #fff;
    margin: 0;
    padding: 0;
    line-height: 1.6;
}
nav {
    background-color: rgba(0,31,63,0.75);
    backdrop-filter: blur(12px);
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(0,255,255,0.2);
    border-bottom: 1px solid #004080;
}
.logo-left img, .logo-right img { height: 100px; }
.nav-title h1 {
    color: #00f0ff;
    font-size: 2.0rem;
    font-weight: 700;
    margin: 0;
    text-align: center;
    background: linear-gradient(90deg, #00f0ff, #00ffae, #00f0ff);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
}
.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}
.header {
    text-align: center;
    margin-bottom: 1rem;
}
.header h1 { color: #FFD700; font-size:2rem; margin-bottom:0.3rem; }

.main-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    align-items: flex-start;
}

/* Mapa */
#map {
    flex: 1 1 350px;
    min-width: 300px;
    max-width: 400px;
    height: 400px;
    border-radius: 16px;
    border: 2px solid #ffd54f;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Datos meteorol√≥gicos */
.grid {
    flex: 2 1 500px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1.5rem;
}

/* Rosa de vientos */
.rose-container {
    flex: 1 1 300px;
    min-width: 350px;
    max-width: 450px;
    height: 450px;
    display: flex;
    justify-content: center;
    align-items: center;
}
.rose-container svg {
    width: 100%;
    height: 100%;
}

/* Tarjetas */
.card {
    background: linear-gradient(145deg,#e0f7fa,#b2ebf2);
    padding:1rem;
    border-radius:20px;
    box-shadow:0 5px 20px rgba(0,0,0,0.3);
    text-align:center;
    transition:all 0.3s ease;
}
.card:hover {
    transform:translateY(-5px);
    box-shadow:0 12px 25px rgba(0,0,0,0.45);
}
.label {
    font-weight:900;
    margin-bottom:0.5rem;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:0.4rem;
    font-size:1.2rem;
    color:#004d40;
}
.value { font-size:1.7rem; color:#004d40; }
#ultimaActualizacion {
    width:100%;
    text-align:center;
    font-size:1rem;
    margin-top:1rem;
    color: #FFD700;
    font-weight:700;
}

/* Footer */
footer {
    margin-top: 50px;
    padding: 20px;
    font-size: 0.9rem;
    background: linear-gradient(180deg, rgba(0,240,255,0.05), rgba(0,0,0,0.6));
    border-top: 1px solid rgba(0,240,255,0.3);
    text-align: center;
    color: #00f0ff;
}
</style>
</head>
<body>

<nav>
    <div class="logo-left">
        <img src="https://archive.org/download/imagen_mejorada_3D/ppp.png" alt="Logo Izquierdo">
    </div>
    <div class="nav-title">
        <h1> üå¶ Club N√°utico Reloncav√≠ üå¶</h1>
    </div>
    <div class="logo-right">
        <img src="https://archive.org/download/imagen_mejorada_3D/LOGO%20METEOPMO.png" alt="Logo Derecho">
    </div>
</nav>

<div class="container">
    <div class="header"></div>

    <div class="main-grid">
        <div class="rose-container">
            <svg id="windRose" viewBox="0 0 240 240">
                <defs>
                    <radialGradient id="arrowGradient" cx="50%" cy="50%" r="50%">
                        <stop offset="0%" stop-color="#FFD700" stop-opacity="1"/>
                        <stop offset="100%" stop-color="#FFA500" stop-opacity="0.6"/>
                    </radialGradient>
                </defs>
                <circle cx="120" cy="120" r="110" fill="rgba(135, 206, 250, 0.4)"/>
                <circle cx="120" cy="120" r="90" fill="none" stroke="#ffffff40" stroke-width="1.2"/>
                <circle cx="120" cy="120" r="70" fill="none" stroke="#ffffff40" stroke-width="1.2"/>
                <g stroke="#ffffff50" stroke-width="1.5">
                    <line x1="120" y1="10" x2="120" y2="24"/>
                    <line x1="230" y1="120" x2="216" y2="120"/>
                    <line x1="120" y1="230" x2="120" y2="216"/>
                    <line x1="10" y1="120" x2="24" y2="120"/>
                </g>
                <g font-size="27" text-anchor="middle" fill="red" font-weight="700">
                    <text x="120" y="26">N</text><text x="214" y="124">E</text>
                    <text x="120" y="220">S</text><text x="26" y="124">W</text>
                </g>
                <g id="degreeNumbers"></g>
                <g id="arrow" transform="rotate(0 120 120)">
                    <line x1="120" y1="120" x2="120" y2="40" stroke="url(#arrowGradient)" stroke-width="6" stroke-linecap="round"/>
                    <polygon points="120,28 112,48 128,48" fill="url(#arrowGradient)"/>
                    <line id="tail" x1="120" y1="120" x2="120" y2="120" stroke="url(#arrowGradient)" stroke-width="6" stroke-linecap="round" opacity=".6"/>
                </g>
                <circle id="intensityRing" cx="120" cy="120" r="40" fill="none" stroke="#FFD700" stroke-width="4" stroke-linecap="round" stroke-opacity=".65"/>
                <text id="windSpeedText" x="120" y="128" text-anchor="middle" font-size="18" font-weight="600" fill="#FFD700">-- nds</text>
            </svg>
        </div>

        <div class="grid">
            <div class="card"><div class="label">üå¨ Viento</div><div id="viento" class="value">--</div></div>
            <div class="card"><div class="label">üí® Rachas</div><div id="Rachas" class="value">-- nds</div></div>
            <div class="card"><div class="label">üå° Temperatura</div><div id="temp_actual" class="value">-- ¬∞C</div></div>
            <div class="card"><div class="label">üíß Humedad</div><div id="humedad" class="value">-- %</div></div>
            <div class="card"><div class="label">üß≠ Presi√≥n</div><div id="presion" class="value">-- hPa</div></div>
            <div class="card"><div class="label">üå° Temp. m√°xima</div><div id="temp_max" class="value">-- ¬∞C</div></div>
            <div class="card"><div class="label">üå° Temp. m√≠nima</div><div id="temp_min" class="value">-- ¬∞C</div></div>
            <div class="card"><div class="label">üåßÔ∏è Precipitaci√≥n</div><div id="Precipitacion" class="value">-- mm</div></div>
        </div>

        <div id="map"></div>
    </div>

    <div id="ultimaActualizacion">√öltima actualizaci√≥n: --</div>
</div>

<footer>
Creado por Cabo 2¬∫ (Met.) Francisco Salas Mu√±oz - 14/09/2025
</footer>

<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
<script>
function convertirGradosAPuntoCardinal(grados){
  const direcciones = ['N','NNE','NE','ENE','E','ESE','SE','SSE','S','SSW','SW','WSW','W','WNW','NW','NNW'];
  return direcciones[Math.round(grados/22.5)%16];
}

function dibujarNumerosRosa(){
  const g = document.getElementById('degreeNumbers'); g.innerHTML='';
  const centerX=120, centerY=120, radius=100;
  for(let deg=0; deg<360; deg+=30){
    const rad=(deg-90)*Math.PI/180;
    const x=centerX+radius*Math.cos(rad);
    const y=centerY+radius*Math.sin(rad);
    const text=document.createElementNS("http://www.w3.org/2000/svg","text");
    text.setAttribute('x',x); text.setAttribute('y',y+4);
    text.setAttribute('text-anchor','middle'); text.setAttribute('fill','#ffeb3b');
    text.setAttribute('font-size','14'); text.setAttribute('font-weight','700'); 
    text.textContent=deg+'¬∞';
    g.appendChild(text);
  }
}
dibujarNumerosRosa();

function actualizarRosaAnimada(dir, spd){
  document.getElementById('arrow').setAttribute('transform',`rotate(${dir} 120 120)`);
  const k = Math.max(0, Math.min(spd/60, 1));
  document.getElementById('tail').setAttribute('y2', String(120 + 10 + (70 - 10) * k));
  document.getElementById('intensityRing').setAttribute('r', (30 + (95 - 30) * k).toFixed(1));
  document.getElementById('windSpeedText').textContent = `${spd} nds`;
}

// Cargar datos de WeatherLink/Seno Reloncav√≠
async function cargarDatos(){
  try{
    const response = await fetch(`https://corsproxy.io/?https://www.weatherlink.com/embeddablePage/getData/2bc9e7ae099849478a8ce1e4c5128e6d`);
    const datos = await response.json();

    document.getElementById('temp_actual').textContent = datos.temperature + ' ¬∞C';
    document.getElementById('temp_max').textContent = datos.hiTemp + ' ¬∞C';
    document.getElementById('temp_min').textContent = datos.loTemp + ' ¬∞C';
    document.getElementById('humedad').textContent = datos.humidity + ' %';
    document.getElementById('presion').textContent = datos.barometer + ' hPa';
    document.getElementById('Precipitacion').textContent = datos.rain + ' mm';

    const dir = datos.windDirection || 0;
    const spd = datos.wind || 0;
    const racha = datos.gust || 0;

    document.getElementById('viento').textContent = `${dir}¬∞ (${convertirGradosAPuntoCardinal(dir)}) ${spd} nds`;
    document.getElementById('Rachas').textContent = `${racha} nds`;

    actualizarRosaAnimada(dir, spd);

    document.getElementById('ultimaActualizacion').textContent = `√öltima actualizaci√≥n: ${new Date().toLocaleString()}`;
  } catch(e){ console.error('Error cargando datos:', e); }
}

cargarDatos();
setInterval(cargarDatos, 5*60*1000);

// Mapa
const map = L.map('map').setView([-41.4990, -72.9881], 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

L.marker([-41.4990, -72.9881]).addTo(map)
  .bindPopup('üìç Club N√°utico Reloncav√≠');
</script>
</body>
</html>
